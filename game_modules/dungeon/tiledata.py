from enum import Enum

VERBOSE = False


class Tiles(Enum):  # I should remove these hard codings
    VOID = 0, "░", "\n".join(
        [
            "░░░░░░░░░░░░░░░░",
            "░░░░░░░░░░░░░░░░",
            "░░░░░░░░░░░░░░░░",
            "░░░░░░░░░░░░░░░░",
            "░░░░░░░░░░░░░░░░",
            "░░░░░░░░░░░░░░░░",
            "░░░░░░░░░░░░░░░░",
            "░░░░░░░░░░░░░░░░",
            "░░░░░░░░░░░░░░░░",
            "░░░░░░░░░░░░░░░░",
            "░░░░░░░░░░░░░░░░",
            "░░░░░░░░░░░░░░░░",
            "░░░░░░░░░░░░░░░░",
            "░░░░░░░░░░░░░░░░",
            "░░░░░░░░░░░░░░░░",
            "░░░░░░░░░░░░░░░░"
        ]
    )

    WALL_HORIZONTAL = 1, "═", "\n".join(
        [
            "░░░░░░░░░░░░░░░░",
            "░░░░░░░░░░░░░░░░",
            "████████████████",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "████████████████",
            "░░░░░░░░░░░░░░░░",
            "░░░░░░░░░░░░░░░░"

        ]
    )
    WALL_VERTICAL = 2, "║", "\n".join(
        [
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░"
        ]
    )

    WALL_T_UP = 3, "╩", "\n".join(
        [
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "███▓▓▓▓▓▓▓▓▓▓███",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "████████████████",
            "░░░░░░░░░░░░░░░░",
            "░░░░░░░░░░░░░░░░"

        ]
    )
    WALL_T_DOWN = 4, "╦", "\n".join(
        [
            "░░░░░░░░░░░░░░░░",
            "░░░░░░░░░░░░░░░░",
            "████████████████",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "███▓▓▓▓▓▓▓▓▓▓███",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░"
        ]
    )
    WALL_T_LEFT = 5, "╠", "\n".join(
        [
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓███",
            "░░█▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "░░█▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "░░█▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "░░█▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "░░█▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "░░█▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "░░█▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "░░█▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "░░█▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "░░█▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "░░█▓▓▓▓▓▓▓▓▓▓███",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░"
        ]
    )
    WALL_T_RIGHT = 6, "╣", "\n".join(
        [
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "███▓▓▓▓▓▓▓▓▓▓█░░",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓█░░",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓█░░",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓█░░",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓█░░",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓█░░",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓█░░",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓█░░",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓█░░",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓█░░",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓█░░",
            "███▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░"
        ]
    )

    WALL_X = 7, "╬", "\n".join(
        [
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "███▓▓▓▓▓▓▓▓▓▓███",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "███▓▓▓▓▓▓▓▓▓▓███",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░"
        ]
    )

    WALL_TR_CORNER = 8, "╗", "\n".join(
        [
            "░░░░░░░░░░░░░░░░",
            "░░░░░░░░░░░░░░░░",
            "██████████████░░",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓█░░",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓█░░",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓█░░",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓█░░",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓█░░",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓█░░",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓█░░",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓█░░",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓█░░",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓█░░",
            "███▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░"
        ]
    )
    WALL_TL_CORNER = 9, "╔", "\n".join(
        [
            "░░░░░░░░░░░░░░░░",
            "░░░░░░░░░░░░░░░░",
            "░░██████████████",
            "░░█▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "░░█▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "░░█▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "░░█▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "░░█▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "░░█▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "░░█▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "░░█▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "░░█▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "░░█▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "░░█▓▓▓▓▓▓▓▓▓▓███",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░"
        ]
    )
    WALL_BR_CORNER = 10, "╝", "\n".join(
        [
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "███▓▓▓▓▓▓▓▓▓▓█░░",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓█░░",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓█░░",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓█░░",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓█░░",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓█░░",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓█░░",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓█░░",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓█░░",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓█░░",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓█░░",
            "██████████████░░",
            "░░░░░░░░░░░░░░░░",
            "░░░░░░░░░░░░░░░░"
        ]
    )
    WALL_BL_CORNER = 11, "╚", "\n".join(
        [
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓█░░",
            "░░█▓▓▓▓▓▓▓▓▓▓███",
            "░░█▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "░░█▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "░░█▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "░░█▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "░░█▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "░░█▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "░░█▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "░░█▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "░░█▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "░░█▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "░░██████████████",
            "░░░░░░░░░░░░░░░░",
            "░░░░░░░░░░░░░░░░"
        ]
    )

    FLOOR = 12, "▓", "\n".join(
        [
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓"
        ]
    )

    ENTRANCE = 13, "∩", "\n".join(
        [
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▄▄▄▄▄▄▄▄▓▓▓▓",
            "▓▓▓▓▌░░░░░░▐▓▓▓▓",
            "▓▓▓▓▌░░░░░░▐▓▓▓▓",
            "▓▓▓▓▌░░░░░░▐▓▓▓▓",
            "▓▓▓▓▌░░░░░░▐▓▓▓▓",
            "▓▓▓▓▌░░░░░░▐▓▓▓▓",
            "▓▓▓▓▌░░░░░░▐▓▓▓▓",
            "▓▓▓▓▌░░░░░░▐▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓"
        ]
    )

    BOSS = 14, "◙", "\n".join(
        [
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓◙◙◙◙◙◙◙◙▓▓▓▓",
            "▓▓▓▓◙◙◙◙◙◙◙◙▓▓▓▓",
            "▓▓▓▓◙◙◙◙◙◙◙◙▓▓▓▓",
            "▓▓▓▓◙◙◙◙◙◙◙◙▓▓▓▓",
            "▓▓▓▓◙◙◙◙◙◙◙◙▓▓▓▓",
            "▓▓▓▓◙◙◙◙◙◙◙◙▓▓▓▓",
            "▓▓▓▓◙◙◙◙◙◙◙◙▓▓▓▓",
            "▓▓▓▓◙◙◙◙◙◙◙◙▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓"
        ]
    )

    HOARD = 15, "⌂", "\n".join(
        [
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓⌂⌂⌂⌂⌂⌂⌂⌂▓▓▓▓",
            "▓▓▓▓⌂⌂⌂⌂⌂⌂⌂⌂▓▓▓▓",
            "▓▓▓▓⌂⌂⌂⌂⌂⌂⌂⌂▓▓▓▓",
            "▓▓▓▓⌂⌂⌂⌂⌂⌂⌂⌂▓▓▓▓",
            "▓▓▓▓⌂⌂⌂⌂⌂⌂⌂⌂▓▓▓▓",
            "▓▓▓▓⌂⌂⌂⌂⌂⌂⌂⌂▓▓▓▓",
            "▓▓▓▓⌂⌂⌂⌂⌂⌂⌂⌂▓▓▓▓",
            "▓▓▓▓⌂⌂⌂⌂⌂⌂⌂⌂▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓",
            "▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓"
        ]
    )

    def __new__(cls, value, char, tile):
        obj = object.__new__(cls)
        obj._value_ = value
        obj.char = char
        obj.tile = tile
        return obj

    @classmethod
    def from_char(cls, char):
        for t in cls:
            if t.char == char:
                return t
        raise ValueError(f"No tile found for char {char}")

    @classmethod
    def from_name(cls, name):
        for t in cls:
            if t.name == name:
                return t

    def __hash__(self):
        return self.value

    def __str__(self):
        return self.char

    @classmethod
    def get_tile_from_char(cls, char) -> str:
        for tile in cls:
            if tile.char == char:
                return tile.tile

    @staticmethod
    def convert_to_tiles(char_grid):
        grid = []
        for column in char_grid:
            col = []
            for row in column:
                col.append([list(row) for row in Tiles.get_tile_from_char(row).split("\n")])
            for row in zip(*col):
                _t = []
                for t in row:
                    _t.extend(t)
                grid.append(_t)
        return grid

    @staticmethod
    def excluded_from_generation():
        return [
            Tiles.ENTRANCE,
            Tiles.BOSS,
            Tiles.HOARD,
        ]

    @classmethod
    def walkable(cls):
        return ["▓", "⌂", "◙"]

    def is_walkable(self):
        return self.char in self.walkable

    @staticmethod
    def get_walkable_tiles(grid: list[list[str]]):
        return [[tile in Tiles.walkable() for tile in row] for row in grid]

    @staticmethod
    def pretty_print_tiles(tile_grid):
        for row in tile_grid:
            print("".join(row))

    @staticmethod
    def tiles_to_string(tiles):
        return "\n".join(["".join(row) for row in tiles])

    @staticmethod
    def parse(string):
        tile_set = []
        if VERBOSE:
            print(f"Parsing \n{string}")
        for line in string.split("\n"):
            if VERBOSE:
                print(f"Parsing line {line}")
            tile_set.append([])
            for char in line:
                if char == " ":
                    continue
                if VERBOSE:
                    print(f"Parsing char {char}")
                tile = Tiles.from_char(char)
                if VERBOSE:
                    print(f"Got tile {tile}")
                if tile is None:
                    raise Exception(f"Invalid tile: {char}")
                tile_set[-1].append(tile)
        return tile_set


class Direction(Enum):
    North = (-1, 0), "↑"

    South = (1, 0), "↓"

    East = (0, 1), "→"

    West = (0, -1), "←"

    North_East = (-1, 1), "↗"

    North_West = (-2, -2), "↖"

    South_East = (1, 1), "↘"

    South_West = (1, -1), "↙"

    def __new__(cls, value: tuple[int, int], char):
        obj = object.__new__(cls)
        obj._value_ = value
        obj.char = char
        return obj

    @property
    def opposite(self):
        return Direction.get_from_value((-self.value[0], -self.value[1]))

    @classmethod
    def get_from_value(cls, param):
        for direction in cls:
            if direction.value == param:
                return direction
        return None

    @property
    def x(self):
        return self.value[0]

    @property
    def y(self):
        return self.value[1]
